<pre>
 <code id="htmlViewer" style="color:rgb(248, 248, 242); font-weight:400;display:block;padding: .5em;"><span style="color:rgb(220, 198, 224); font-weight:400;">if</span>(my_behaviour == ai_state.following) {
	<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> closest_distance = point_distance(target_obj.x, target_obj.y, x, y);
	<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> mov_x = <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>;
	<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> mov_y = <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>;
	<span style="color:rgb(220, 198, 224); font-weight:400;">for</span>(<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> i = <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>; i &lt; <span style="color:rgb(245, 171, 53); font-weight:400;">4</span>; i++) {
		<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> dx = <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">var</span> dy = <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>;
		<span style="color:rgb(220, 198, 224); font-weight:400;">switch</span>(i) {
			<span style="color:rgb(220, 198, 224); font-weight:400;">case</span> <span style="color:rgb(245, 171, 53); font-weight:400;">0</span>: dy= <span style="color:rgb(245, 171, 53); font-weight:400;">-1</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">break</span>;
			<span style="color:rgb(220, 198, 224); font-weight:400;">case</span> <span style="color:rgb(245, 171, 53); font-weight:400;">1</span>: dx = <span style="color:rgb(245, 171, 53); font-weight:400;">-1</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">break</span>;
			<span style="color:rgb(220, 198, 224); font-weight:400;">case</span> <span style="color:rgb(245, 171, 53); font-weight:400;">2</span>: dy = <span style="color:rgb(245, 171, 53); font-weight:400;">1</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">break</span>;
			<span style="color:rgb(220, 198, 224); font-weight:400;">case</span> <span style="color:rgb(245, 171, 53); font-weight:400;">3</span>: dx = <span style="color:rgb(245, 171, 53); font-weight:400;">1</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">break</span>;
			<span style="color:rgb(245, 171, 53); font-weight:400;">default</span>: dx = <span style="color:rgb(245, 171, 53); font-weight:400;">1</span>; <span style="color:rgb(220, 198, 224); font-weight:400;">break</span>;
		}
		
		<span style="color:rgb(220, 198, 224); font-weight:400;">var</span> dist = point_distance(target_obj.x, target_obj.y, x + <span style="color:rgb(220, 198, 224); font-weight:400;">global</span>.grid_size*dx, y+<span style="color:rgb(220, 198, 224); font-weight:400;">global</span>.grid_size*dy);

		<span style="color:rgb(220, 198, 224); font-weight:400;">if</span>(try_move(dx, dy) || dist &lt; <span style="color:rgb(220, 198, 224); font-weight:400;">global</span>.grid_size) {
			<span style="color:rgb(220, 198, 224); font-weight:400;">if</span>(dist &lt; closest_distance) {
				closest_distance = dist;
				mov_x = dx;
				mov_y = dy;
			}
		}
	}
	
	grid_movement(mov_x, mov_y);
}</code></pre>
